# 3.3 MyISAM 스토리지 엔진 아키텍처

- MyISAM 스토리지 엔진의 성능에 영향을 미치는 요소인 키 캐시와 운영체제의 캐시, 버퍼에 대해 살펴보자.

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6bf58802-3f5b-4cb6-bd66-848cf15a5799/Untitled.png](https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F6bf58802-3f5b-4cb6-bd66-848cf15a5799%2FUntitled.png?table=block&id=e5307df3-deaf-4438-9289-488618ebdc0d&spaceId=5723e4f7-61fe-4e85-9214-fdffa6ca70b4&width=2040&userId=&cache=v2)

<br>

## 3.3.1 키 캐시

- InnoDB의 버퍼 풀과 비슷한 역할을 수행하는 보조 저장소이다.
- 키 캐시는 인덱스를 대상으로만 작동하며 인덱스의 디스크 쓰기 작업에 대해서만 부분적으로 버퍼링 역할을 수행한다.
- 매뉴얼에 따르면 일반적으로 키 캐시를 이용한 쿼리의 비율을 99% 이상 유지하는 것을 권장한다.
- 히트율이 99% 미만이라면 키 캐시를 조금 더 크게 설정하는 것이 좋다.

<br>

> 정리

- MyISAM에서는 InnoDB의 버퍼 풀과 비슷한 역할을 수행하는 보조 저장소인 키 캐시를 가지고 있다.
- InnoDB의 버퍼 풀이 데이터 파일과 인덱스 파일을 캐시해두고 쓰기 지연 버퍼로서의 역할을 수행한다면 키 캐시는 오로지 인덱스를 대상으로만 수행된다.
- 키 캐시는 인덱스를 대상으로만 캐시를 수행하며 인덱스의 쓰기 작업에 대해서만 부분적으로 버퍼 역할을 수행한다.

<br>

## 3.3.2 운영체제의 캐시 및 버퍼

- MyISAM 테이블의 인덱스는 키 캐시를 이용해 디스크를 검색하지 않아도 빠르게 검색될 수 있다.
- MyISAM 테이블의 데이터는 디스크로부터 IO를 해결해줄 만한 어떠한 캐시나 버퍼링 기능이 존재하지 않는다.
- MyISAM 테이블의 데이터 읽기나 쓰기 작업은 항상 운영체제의 디스크 읽기 또는 쓰기 작업으로 요청될 수 밖에 없다.
- 운영체제는 디스크로부터 읽고 쓰는 작업에 대한 캐시나 버퍼링 매커니즘을 가지고 있기 때문에 요청에 따라 매번 디스크 읽기 작업을 수행하지는 않는다.
- 운영체제의 캐시 기능은 InnoDB와 같이 데이터의 특성을 알고 전문적으로 캐시 또는 버퍼링 하지 못하지만 없는 것보다는 나은 성능을 보인다.
- 운영체제의 캐시 공간은 남는 메모리를 사용하는 것이 기본 원칙이므로 전체 메모리를 다른 애플리케이션에서 모두 사용해버린다면 운영체제가 캐시로 사용할 수 있는 공간이 없어진다.
- 이 경우에는 MyISAM 테이블의 데이터를 캐시할 수 없게 되며 처리가 느려지게 된다.

<br>

> 정리

- MyISAM 스토리지 엔진은 데이터를 디스크로부터 읽고 쓰는데 어떠한 캐시나 버퍼링 기능을 지원하지 않는다.
- 하지만 운영체제 수준에서 디스크 쓰기와 읽기에 대한 캐시 기능을 지원하기 때문에 어느정도 성능을 보완해주고 있지만 InnoDB 처럼 데이터의 특성을 고려한 전문적인 캐싱을 지원하지 않는다.
- 뿐만 아니라 메모리의 남는 공간을 캐시로 활용하기 때문에 다른 애플리케이션에 의해 메모리가 모두 사용되고 있다면 캐시로 사용할 수 있는 공간이 없으므로 MyISAM 테이블의 데이터를 캐시할 수 없다.
- 이 경우에는 데이터를 디스크로 부터 읽는 작업에 대한 어떠한 최적화도 적용할 수 없기 때문에 쿼리의 처리 속도가 느려지게 된다.
